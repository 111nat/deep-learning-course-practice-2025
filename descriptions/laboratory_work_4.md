# Лабораторная работа 4: Семантическая сегментация с использованием PyTorch

## Цели работы

Цель — разработать и обучить сверточную нейронную сеть для задачи мультиклассовой семантической сегментации изображений на наборе данных [SUIM](https://www.kaggle.com/datasets/ashish2001/semantic-segmentation-of-underwater-imagery-suim) с использованием PyTorch.

---

## Задачи работы

Выполнение лабораторной работы предполагает решение следующих задач:

1. Загрузить набор данных SUIM и выполнить предобработку данных, если это необходимо.
2. Реализовать нейронную сеть с использованием фреймворка PyTorch для решения задачи мультиклассовой семантической сегментации.
3. Выбрать подходящую функцию потерь и настроить гиперпараметры обучения.
4. Обучить реализованную нейронную сеть и провести оценку её эффективности.

---

## Набор данных SUIM

1. Данные содержат 8 классов. Маска сегментации имеет вид трехканального изображения, где пиксели принимают значения либо 0, либо 255. Например, (0, 0, 0), (0, 0, 255) и т.д. Также могут встречаться промежуточные значения, отличные от 0 и 255. В рамках данной лабораторной работы рекомендуется выполнить следующее преобразование: значения маски, меньшие 128, установить в 0, а значения, равные или большие 128, установить в 255.

2. Для упрощения работы рекомендуется объединить следующие классы в один:
- класс 2 — Aquatic plants and sea-grass
- класс 3 — Wrecks and ruins
- класс 5 — Reefs and invertebrates
- класс 7 — Sea-floor and rocks

---

## Требования к результатам выполнения работы

1. Необходимо выполнить и отобразить в Jupyter следующие задачи:

   - Необходимо обеспечить демонстрацию избранных изображений и меток классов для подтверждения корректности загрузки и совпадения размерностей.
   - Разработать архитектуру нейронной сети для сегментации с использованием фреймворка PyTorch.
   - После завершения обучения необходимо посчитать accuracy, [IoU](https://lightning.ai/docs/torchmetrics/latest/segmentation/mean_iou.html) и визуализировать [confusion matrix](https://scikit-learn.org/dev/modules/generated/sklearn.metrics.confusion_matrix.html) (с нормализацией, `normalize='true'`).
   - После завершения обучения построить и отобразить результаты сегментации на тестовых изображениях, сравнивая с реальными масками сегментации.

2. Выбор архитектуры:
   - Можно использовать или адаптировать известные архитектуры глубокого обучения.
   - Может быть полезным:
     - уменьшить количество параметров в нейронной сети и размер входного изображения для ускорения сходимости, предотвращения переобучения и ускорения работы нейронной сети.
     - использовать аугментацию данных и взвешенные/специализированные функции ошибки. При аугментации данных необходимо учитывать связь изображений с маской классов.
   - Использовать перенос знаний **недопустимо**.

---

## Оценивание:

- Количество баллов за лабораторную работу рассчитывается по формуле:  
  $$\text{баллы} = 10 \times \text{знания} \times \text{точность}$$, 

  $$\text{знания} \in [0, 1]$$ — оценка уровня понимания материала, 
  
  $$\text{точность} \in [0, 1]$$ — оценка точности решения задачи. Например, точность классификации 90% — это 0.9.


Качество обученной модели может быть достаточно низким по сравнению с предыдущими работами. Это ожидаемый результат.
